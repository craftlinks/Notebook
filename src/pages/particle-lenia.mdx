---
title: "Particle Lenia GPU Accelerated"
description: "Exploring emergent behaviors in particle systems using GPU-accelerated Lenia algorithms"
layout: "../layouts/Layout.astro"
---

# Particle Lenia.

[Lenia](https://arxiv.org/abs/1812.05433) is a family of cellular automata that produces lifelike behaviors and patterns, first described in the seminal paper by Bert Wang-Chak Chan. 
This project is heavily inspired by the original [Particle Lenia](https://google-research.github.io/self-organising-systems/particle-lenia/) 
research by Alexander Mordvintsev et al., which implemented a particle-based version of Lenia in Python and [JAX](https://docs.jax.dev/en/latest/). 
Recognizing the importance of scale (number of particles) for simulation dynamics and iteration times for rapid pattern exploration, 
I ported the simulation to the GPU and made it 3D. I also added several update kernels in addition to the original Gaussian one and programmed in 
support for multi-species particle simulations which opens up a whole new breed of Mathematical Lifeforms, some that behave very reminiscent to critters found in [Particle Life](https://youtu.be/p4YirERTVF0?si=E2bExaHTX8kbKKtp).

This port was achieved using compute shaders within [Three.js](https://threejs.org/examples/) and the (still unofficial) [Three.js Shading Language (TSL)](https://github.com/mrdoob/three.js/wiki/Three.js-Shading-Language).
You can explore the Particle Lenia universe yourself at the bottom of this post
on the condition that your browser supports [WebGPU](https://developer.mozilla.org/en-US/docs/Web/API/WebGPU_API) 
and you have a graphics card with enough muscle to crunch the numbers.
The source code for the Particle Lenia implementation can be found [here](https://github.com/craftlinks/Notebook/tree/main/particle-lenia), go wild.

## A too short intro to Energy Fields and Particles in Particle Lenia

The **energy field** is defined as  
$$
E(\mathbf{x}) = R(\mathbf{x}) - G(\mathbf{x}),
$$  
where $R$ is the **repulsion field** and $G$ the **growth field** (typically generated by two different convolution kernels). Particles follow the motion law  
$$
\frac{d\mathbf{x}_i}{dt} = -\nabla E(\mathbf{x}_i),
$$  
_i.e._ they drift toward lower energy by simultaneously minimizing repulsion $R$ and maximizing growth $G$. The rich behaviors you see are purely emergent from these local interactions and, to a lesser extent, the choice of kernels (the Mexican-Hat kernel is a personal favorite).

If you're interested in the math, I encourage you to read the exposition in the original [Particle Lenia paper](https://google-research.github.io/self-organising-systems/particle-lenia/). 
It only requires that you understand what a 'gradient' is (ask an LLM) and how to apply the chain-rule for finding the differential equations.

<iframe width="100%" height="480" src="https://www.youtube.com/embed/10gFQXNqus8" title="Particle Lenia demo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## Gallery

Click on any image to view it in full size.

<div class="gallery" id="particle-gallery">
  {/* Images will be loaded dynamically */}
</div>

{/* Modal for full-size viewing */}
<div id="modal" class="modal">
  <span class="close" id="closeModal">&times;</span>
  <span class="nav prev" id="prevModal">&#10094;</span>
  <span class="nav next" id="nextModal">&#10095;</span>
  <div class="modal-content">
    <img id="modalImage" src="" alt="" />
  </div>
</div>


